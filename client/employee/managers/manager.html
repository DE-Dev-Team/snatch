<template name="manager">

<head>
	<title> Bandersnatch - Managers </title>
</head>	
	{{#if isInRole 'manager'}}	
	
	<div class='ManagerContainer'>
	
		<h1> Managers </h1>
		
		<hr>
		
		<div class="row">
			<label id="notif"></label>
		</div>
		<div class="row">
			<button type="button" id="on" class="on">Turn ON</button>
			<button type="button" id="off" class="off">Turn OFF</button>
		</div>
		
		<hr>
		
		<div class="row">
			<button type="button" id="sendEmail" class="email">Send Email</button>
		</div>
		<div class="row">
			<h4 id="notif2">Email Sent!</h4>
		</div>
		
			<label for='recieveEmail'> List of email recipients: </label>
			<ul id='emailList'>
				{{#each recip}}
					{{>emailChain}}
				{{/each}}
			</ul>
			<form id='email'>
				<input type='text' id='recieveEmail'> <button type='button' id='addRecip'> Add Recipient</button>
			</form>

		<hr>
		

		<div class='manage'>
			<div class="newItem">
				<h3> add new menu item </h3>
			        <label class="voffset2" for="itemType">Category of New Item</label>
			        <select id="itemType">
			           <option value="select" id="select">Select</option>
			           <option value="flavor">Shake Flavor</option>
					   <option value="mixin">Shake Mixin</option>
			           <option value="bagel">Bagel</option>
					   <option value="snack">Snack</option>
					   <option value="bev">Beverage</option>
			        </select>
					<div class='name voffset3'>
						<label for='itemTitle'>Name of Item:</label>
						<input type='text' id='itemTitle'>
						<div class='price'>
							<label for='itemPrice'>Price of Item:</label>
							$ <input type="text" class="money" id="dollar"/>.<input type="text" class="money" id="cents"/>
						</div>
					</div>	
				<button type=button id=addNewItem> Add New Item </button>
				<h4 id='notifAdded'> New item added! </h4>
			</div>


			<hr>

			<div class="delItem">
				<h3> delete menu item </h3>
				<form name="findDelItem">
					<select name='first-choice' class='first-choice' id="first-choice">
			           <option value="select" selected='selected'>Select</option>
					   <option value="bagel">Bagel</option>
					   <option value="snack">Snack</option>
					   <option value="bev">Beverage</option>
					   <option value="mixin">Shake Mixin</option>
			           <option value="flavor">Shake Flavor</option>
					</select>
						
					<script>
					var oldChoice = '';
					$('select').change(function() {
						var choice = $('.first-choice').val(); 
						if(choice != 'select' && choice != oldChoice){
							if(oldChoice != ''){
								var sel = document.getElementById('deleteItem');
								while (sel.firstChild) {
								    sel.removeChild(sel.firstChild);
								}
							}
							/*************** DELETE A BAGEL ***************/
							if(choice == 'bagel'){
								var bagels = Bagels.find().fetch(); 
								var sel = document.getElementById('deleteItem');
								var fragment = document.createDocumentFragment();

								bagels.forEach(function(bagel, index) {
								
								    var opt = document.createElement('option');
								    opt.innerHTML = bagel.type;
								    opt.value = bagel.type;
								    fragment.appendChild(opt);
								});
								sel.appendChild(fragment);
							}
							/*************** DELETE A SNACK ***************/
							else if(choice == 'snack'){
								var snacks = Snacks.find().fetch(); 
								var sel = document.getElementById('deleteItem');
								var fragment = document.createDocumentFragment();

								snacks.forEach(function(snack, index) {
								    var opt = document.createElement('option');
								    opt.innerHTML = snack.type;
								    opt.value = snack.type;
								    fragment.appendChild(opt);
								});

								sel.appendChild(fragment);
							}
					
							/*************** DELETE A BEV ***************/
							else if(choice == 'bev'){
								var snacks = Beverages.find().fetch(); 
								var sel = document.getElementById('deleteItem');
								var fragment = document.createDocumentFragment();

								snacks.forEach(function(snack, index) {
								    var opt = document.createElement('option');
								    opt.innerHTML = snack.type;
								    opt.value = snack.type;
								    fragment.appendChild(opt);
								});

								sel.appendChild(fragment);
							}
					
							/*************** DELETE A MIXIN ***************/
							else if(choice == 'mixin'){
								var snacks = Milkshakes.find({type: 'mixin'}).fetch(); 
								var sel = document.getElementById('deleteItem');
								var fragment = document.createDocumentFragment();

								snacks.forEach(function(snack, index) {
								    var opt = document.createElement('option');
								    opt.innerHTML = snack.name;
								    opt.value = snack.name;
								    fragment.appendChild(opt);
								});

								sel.appendChild(fragment);
							}

							/*************** DELETE A FLAVOR ***************/
							else if(choice == 'flavor'){
								var snacks = Milkshakes.find({type: 'flavor'}).fetch(); 
								var sel = document.getElementById('deleteItem');
								var fragment = document.createDocumentFragment();

								snacks.forEach(function(thing, index) {
								    var opt = document.createElement('option');
								    opt.innerHTML = thing.name;
								    opt.value = thing.name;
								    fragment.appendChild(opt);
								});

								sel.appendChild(fragment);
							}
						}
						oldChoice = choice;
					});
					</script>  
						
					<select id='deleteItem' class='deleteItem'>
						<option> Delete an Item </option>
					</select>
					<br>
					<button id='delThis'> Delete Item </button>
				</form>
			
			</div>
		</div>
	</div>
	
    <div id="bground">
    		<img src="/img/plainBlack.png" alt="">
    </div>
	
	
   {{else}}
     {{> deniedEmp}}
    {{/if}} 
	
</template>

<template name="emailChain">
	<li id={{indvEmail}}><button class='delEmail'>X</button>{{indvEmail}}</li>
</template>




